{"version":3,"file":"tabs.js","sourceRoot":"","sources":["tabs.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {html, isServer, LitElement, PropertyValues} from 'lit';\nimport {property, queryAssignedElements, state} from 'lit/decorators.js';\n\nimport {Tab, Variant} from './tab.js';\n\nconst NAVIGATION_KEYS = new Map([\n  ['default', new Set(['Home', 'End'])],\n  ['horizontal', new Set(['ArrowLeft', 'ArrowRight'])],\n  ['vertical', new Set(['ArrowUp', 'ArrowDown'])]\n]);\n\n/**\n * @fires change Fired when the selected tab changes. The target's selected or\n * selectedItem and previousSelected or previousSelectedItem provide information\n * about the selection change. The change event is fired when a user interaction\n * like a space/enter key or click cause a selection change. The tab selection\n * based on these actions can be cancelled by calling preventDefault on the\n * triggering `keydown` or `click` event.\n *\n * @example\n * // perform an action if a tab is clicked\n * tabs.addEventListener('change', (event: Event) => {\n *   if (event.target.selected === 2)\n *      takeAction();\n *   }\n * });\n *\n * // prevent a click from triggering tab selection under some condition\n * tabs.addEventListener('click', (event: Event) => {\n *   if (notReady)\n *      event.preventDefault();\n *   }\n * });\n *\n */\nexport class Tabs extends LitElement {\n  static override readonly shadowRootOptions = {\n    ...LitElement.shadowRootOptions,\n    delegatesFocus: true\n  };\n\n  /**\n   * Styling variant to display, 'primary' or 'secondary' and can also\n   * include `vertical`.\n   * Defaults to `primary`.\n   */\n  @property({reflect: true}) variant: Variant = 'primary';\n\n  /**\n   * Whether or not the item is `disabled`.\n   */\n  @property({type: Boolean}) disabled = false;\n\n  /**\n   * Index of the selected item.\n   */\n  @property({type: Number}) selected = 0;\n\n  /**\n   * Whether or not to select an item when focused.\n   */\n  @property({type: Boolean}) selectOnFocus = false;\n\n  private previousSelected = -1;\n  private orientation = 'horizontal';\n  private readonly scrollMargin = 48;\n\n  @queryAssignedElements({selector: 'md-tab', flatten: true})\n  private readonly items!: Tab[];\n\n  // this tracks if items have changed, which triggers rendering so they can\n  // be kept in sync\n  @state() private itemsDirty = false;\n\n  private readonly selectedAttribute = `selected`;\n\n  /**\n   * The item currently selected.\n   */\n  get selectedItem() {\n    return this.items[this.selected];\n  }\n\n  /**\n   * The item previously selected.\n   */\n  get previousSelectedItem() {\n    return this.items[this.previousSelected];\n  }\n\n  /**\n   * The item currently focused.\n   */\n  protected get focusedItem() {\n    return this.items.find((e: HTMLElement) => e.matches(':focus-within'));\n  }\n\n  constructor() {\n    super();\n    if (!isServer) {\n      this.addEventListener('keydown', this.handleKeydown);\n      this.addEventListener('keyup', this.handleKeyup);\n      this.addEventListener('focusout', this.handleFocusout);\n    }\n  }\n\n  override connectedCallback() {\n    super.connectedCallback();\n    this.setAttribute('role', 'tablist');\n  }\n\n  // focus item on keydown and optionally select it\n  private readonly handleKeydown = async (event: KeyboardEvent) => {\n    const {key} = event;\n    const shouldHandleKey = NAVIGATION_KEYS.get('default')!.has(key) ||\n        NAVIGATION_KEYS.get(this.orientation)!.has(key);\n    // await to after user may cancel event.\n    if (!shouldHandleKey || (await this.wasEventPrevented(event, true)) ||\n        this.disabled) {\n      return;\n    }\n    let indexToFocus = -1;\n    const focused = this.focusedItem ?? this.selectedItem;\n    const itemCount = this.items.length;\n    const isPrevKey = key === 'ArrowLeft' || key === 'ArrowUp';\n    if (key === 'Home') {\n      indexToFocus = 0;\n    } else if (key === 'End') {\n      indexToFocus = itemCount - 1;\n    } else {\n      const focusedIndex = this.items.indexOf(focused) || 0;\n      indexToFocus = focusedIndex + (isPrevKey ? -1 : 1);\n      indexToFocus =\n          indexToFocus < 0 ? itemCount - 1 : indexToFocus % itemCount;\n    }\n    const itemToFocus =\n        this.findFocusableItem(indexToFocus, key === 'End' || isPrevKey);\n    indexToFocus = this.items.indexOf(itemToFocus!);\n    if (itemToFocus !== null && itemToFocus !== focused) {\n      this.updateFocusableItem(itemToFocus);\n      itemToFocus.focus();\n      if (this.selectOnFocus) {\n        this.selected = indexToFocus;\n        await this.dispatchInteraction();\n      }\n    }\n  };\n\n  // scroll to item on keyup.\n  private readonly handleKeyup = () => {\n    this.scrollItemIntoView(this.focusedItem ?? this.selectedItem);\n  };\n\n  // restore focus to selected item when blurring.\n  private readonly handleFocusout = async () => {\n    await this.updateComplete;\n    const nowFocused =\n        (this.getRootNode() as unknown as DocumentOrShadowRoot).activeElement as\n        Tab;\n    if (this.items.indexOf(nowFocused) === -1) {\n      this.updateFocusableItem(this.selectedItem);\n    }\n  };\n\n  private findFocusableItem(i = -1, prev = false, tries = 0): Tab|null {\n    const itemCount = this.items.length - 1;\n    while (this.items[i]?.disabled && tries <= itemCount) {\n      tries++;\n      i = (i + (prev ? -1 : 1));\n      if (i > itemCount) {\n        return this.findFocusableItem(0, false, tries);\n      } else if (i < 0) {\n        return this.findFocusableItem(itemCount, true, tries);\n      }\n    }\n    return this.items[i] ?? null;\n  }\n\n  // Note, this is async to allow the event to bubble to user code, which\n  // may call `preventDefault`. If it does, avoid performing the tabs action\n  // which is selecting a new tab. Sometimes, the native event must be\n  // prevented to avoid, for example, scrolling. In this case, the event is\n  // patched to be able to detect if the user calls prevent default.\n  // Alternatively, the event could be stopped and re-dispatched synchroously,\n  // but this would be complicated since the event should be re-dispatched from\n  // the initial element to potentially trigger a native action (e.g. a history\n  // navigation via a tab label), and this could result in some listener hearing\n  // 2x events.\n  private async wasEventPrevented(event: Event, preventNativeDefault = false) {\n    if (preventNativeDefault) {\n      // prevent native default to stop, e.g. scrolling.\n      event.preventDefault();\n      // reset prevention to see if user is cancelling this action.\n      Object.defineProperties(event, {\n        'defaultPrevented': {value: false, writable: true, configurable: true},\n        'preventDefault': {\n          value() {\n            this.defaultPrevented = true;\n          },\n          writable: true,\n          configurable: true\n        }\n      });\n    }\n    // allow event to propagate to user code.\n    await new Promise(requestAnimationFrame);\n    return event.defaultPrevented;\n  }\n\n  private async dispatchInteraction() {\n    // wait for items to render.\n    await new Promise(requestAnimationFrame);\n    const event = new Event('change', {bubbles: true});\n    this.dispatchEvent(event);\n  }\n\n  protected override willUpdate(changed: PropertyValues) {\n    if (changed.has('selected')) {\n      this.previousSelected = changed.get('selected') ?? -1;\n    }\n    if (changed.has('variant')) {\n      this.orientation =\n          this.variant.includes('vertical') ? 'vertical' : 'horizontal';\n    }\n    if (this.itemsDirty) {\n      this.itemsDirty = false;\n      this.previousSelected = -1;\n    }\n  }\n\n  protected override async updated(changed: PropertyValues) {\n    const itemsOrVariantChanged =\n        changed.has('itemsDirty') || changed.has('variant');\n    // sync state with items.\n    if (itemsOrVariantChanged || changed.has('disabled')) {\n      this.items.forEach((item, i) => {\n        item.selected = this.selected === i;\n        item.variant = this.variant;\n        item.disabled = this.disabled;\n      });\n    }\n    if (itemsOrVariantChanged || changed.has('selected')) {\n      if (this.previousSelectedItem !== this.selectedItem) {\n        this.previousSelectedItem?.removeAttribute(this.selectedAttribute);\n        this.selectedItem?.setAttribute(this.selectedAttribute, '');\n      }\n      if (this.selectedItem !== this.focusedItem) {\n        this.updateFocusableItem(this.selectedItem);\n      }\n      await this.scrollItemIntoView();\n    }\n  }\n\n  private updateFocusableItem(focusableItem: HTMLElement|null) {\n    for (const item of this.items) {\n      item.focusable = item === focusableItem;\n    }\n  }\n\n  protected override render() {\n    return html`\n      <slot @slotchange=${this.handleSlotChange} @click=${\n        this.handleItemClick}></slot>  \n    `;\n  }\n\n  private async handleItemClick(event: Event) {\n    const {target} = event;\n    if (await this.wasEventPrevented(event)) {\n      return;\n    }\n    const item = (target as Element).closest(`${this.localName} > *`) as Tab;\n    const i = this.items.indexOf(item);\n    if (i > -1 && this.selected !== i) {\n      this.selected = i;\n      this.updateFocusableItem(this.selectedItem);\n      // note, Safari will not focus the button here, but if focus is manually\n      // triggered, this can match focus-visible and show the focus-ring,\n      // so avoid the temptation to cal focus!\n      await this.dispatchInteraction();\n    }\n  }\n\n  private handleSlotChange() {\n    this.itemsDirty = true;\n  }\n\n  private async itemsUpdateComplete() {\n    for (const item of this.items) {\n      await item.updateComplete;\n    }\n    return true;\n  }\n\n  // ensures the given item is visible in view; defaults to the selected item\n  private async scrollItemIntoView(item = this.selectedItem) {\n    if (!item) {\n      return;\n    }\n    // wait for items to render.\n    await this.itemsUpdateComplete();\n    const isVertical = this.orientation === 'vertical';\n    const offset = isVertical ? item.offsetTop : item.offsetLeft;\n    const extent = isVertical ? item.offsetHeight : item.offsetWidth;\n    const scroll = isVertical ? this.scrollTop : this.scrollLeft;\n    const hostExtent = isVertical ? this.offsetHeight : this.offsetWidth;\n    const min = offset - this.scrollMargin;\n    const max = offset + extent - hostExtent + this.scrollMargin;\n    const to = Math.min(min, Math.max(max, scroll));\n    const behavior =\n        // type annotation because `instant` is valid but not included in type.\n        this.focusedItem !== undefined ? 'smooth' : 'instant' as ScrollBehavior;\n    this.scrollTo({\n      behavior,\n      [isVertical ? 'left' : 'top']: 0,\n      [isVertical ? 'top' : 'left']: to\n    });\n  }\n}\n"]}